<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Private API · SDiagonalizability.jl</title><meta name="title" content="Private API · SDiagonalizability.jl"/><meta property="og:title" content="Private API · SDiagonalizability.jl"/><meta property="twitter:title" content="Private API · SDiagonalizability.jl"/><meta name="description" content="Documentation for SDiagonalizability.jl."/><meta property="og:description" content="Documentation for SDiagonalizability.jl."/><meta property="twitter:description" content="Documentation for SDiagonalizability.jl."/><meta property="og:url" content="https://GraphQuantum.github.io/SDiagonalizability.jl/private_api/"/><meta property="twitter:url" content="https://GraphQuantum.github.io/SDiagonalizability.jl/private_api/"/><link rel="canonical" href="https://GraphQuantum.github.io/SDiagonalizability.jl/private_api/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/styles.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.jpg" alt="SDiagonalizability.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">SDiagonalizability.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../public_api/">Public API</a></li><li class="is-active"><a class="tocitem" href>Private API</a><ul class="internal"><li><a class="tocitem" href="#References"><span>References</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Private API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Private API</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/GraphQuantum/SDiagonalizability.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/GraphQuantum/SDiagonalizability.jl/blob/main/docs/src/private_api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="SDiagonalizability.jl-–-Private-API"><a class="docs-heading-anchor" href="#SDiagonalizability.jl-–-Private-API">SDiagonalizability.jl – Private API</a><a id="SDiagonalizability.jl-–-Private-API-1"></a><a class="docs-heading-anchor-permalink" href="#SDiagonalizability.jl-–-Private-API" title="Permalink"></a></h1><p>Documentation for <a href="https://github.com/GraphQuantum/SDiagonalizability.jl">SDiagonalizability</a>&#39;s private API.</p><div class="admonition is-info" id="Note-e146e82dfde0b0fe"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-e146e82dfde0b0fe" title="Permalink"></a></header><div class="admonition-body"><p>The following documentation covers only the private API of the package. For public details, see the <a href="../public_api/">public API documentation</a>.</p></div></div><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SDiagonalizability.AbstractSBandResult" href="#SDiagonalizability.AbstractSBandResult"><code>SDiagonalizability.AbstractSBandResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractSBandResult</code></pre><p>Abstract base type for all <em>S</em>-bandwidth problem results.</p><p><strong>Interface</strong></p><p>Concrete subtypes of <code>AbstractSBandResult</code> <em>must</em> implement parametric types</p><ul><li><code>A&lt;:Union{AbstractGraph,AbstractMatrix{&lt;:Integer}}</code>;</li><li><code>B&lt;:Tuple</code>; and</li><li><code>C&lt;:Union{Nothing,Eigen}</code>,</li></ul><p>alongside the following fields:</p><ul><li><code>network::A</code>: the network whose <em>S</em>-bandwidth is investigated;</li><li><code>S::B</code>: the set <em>S</em> from whose entries we are allowed to construct eigenvectors;</li><li><code>diagonalization::C</code>: an <em>S</em>-diagonalization of the matrix representation of the network,   if it satisfies the specified <em>S</em>-bandwidth constraints; otherwise, <code>nothing</code>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GraphQuantum/SDiagonalizability.jl/blob/4121fb25fe287e2c320ac12784444e5551a95828/src/types.jl#L7-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SDiagonalizability.EfficiencyWarning" href="#SDiagonalizability.EfficiencyWarning"><code>SDiagonalizability.EfficiencyWarning</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EfficiencyWarning(msg)</code></pre><p>[TODO: Write here]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GraphQuantum/SDiagonalizability.jl/blob/4121fb25fe287e2c320ac12784444e5551a95828/src/types.jl#L174-L178">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SDiagonalizability.NotImplementedError" href="#SDiagonalizability.NotImplementedError"><code>SDiagonalizability.NotImplementedError</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">NotImplementedError{Nothing}(f, subtype, abstracttype)
NotImplementedError{Symbol}(f, arg, subtype, abstracttype)</code></pre><p>An exception indicating that a function lacks dispatch to handle a specific argument type.</p><p>Semantically, this differs from <code>MethodError</code> in that it connotes a developer-side failure to implement a method rather than erroneous user input. Throughout this package, it is often used to warn when an existing function with multiple dispatch on some abstract type is called on a newly created subtype for which no method has been defined.</p><p><strong>Fields</strong></p><ul><li><code>f::Function</code>: the function called.</li><li><code>arg::Symbol</code>: the name of the argument with the unsupported type, if the function has   multiple arguments. If the function has only one argument, this field should be set to   <code>nothing</code>.</li><li><code>subtype::Type</code>: the type of the argument. May be the actual concrete type or some   intermediate supertype. (For instance, if the relevant input has concrete type <code>A</code> with   hierarchy <code>A &lt;: B &lt;: C</code> and the <code>abstracttype</code> field is <code>C</code>, then both <code>A</code> and <code>B</code> are   perfectly valid choices for <code>subtype</code>.)</li><li><code>abstracttype::Type</code>: the abstract type under which the argument is meant to fall.</li></ul><p><strong>Constructors</strong></p><ul><li><code>NotImplementedError(::Function, ::Type, ::Type)</code>: constructs a new <code>NotImplementedError</code>   instance for a single-argument function. Throws an error if the second type is not   abstract or the first type is not a subtype of the second.</li><li><code>NotImplementedError(::Function, ::Symbol, ::Type, ::Type)</code>: constructs a new   <code>NotImplementedError</code> instance for a multi-argument function. Throws an error if the   second type is not abstract or the first type is not a subtype of the second.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GraphQuantum/SDiagonalizability.jl/blob/4121fb25fe287e2c320ac12784444e5551a95828/src/types.jl#L99-L128">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SDiagonalizability.SBandMinimizationResult" href="#SDiagonalizability.SBandMinimizationResult"><code>SDiagonalizability.SBandMinimizationResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SBandMinimizationResult{A,B,C,D} &lt;: AbstractSBandResult</code></pre><p>[TODO: Write here]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GraphQuantum/SDiagonalizability.jl/blob/4121fb25fe287e2c320ac12784444e5551a95828/src/types.jl#L26-L30">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SDiagonalizability.SBandRecognitionResult" href="#SDiagonalizability.SBandRecognitionResult"><code>SDiagonalizability.SBandRecognitionResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SBandRecognitionResult{A,B,C} &lt;: AbstractSBandResult</code></pre><p>[TODO: Write here]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GraphQuantum/SDiagonalizability.jl/blob/4121fb25fe287e2c320ac12784444e5551a95828/src/types.jl#L43-L47">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SDiagonalizability.SpectrumIntegralResult" href="#SDiagonalizability.SpectrumIntegralResult"><code>SDiagonalizability.SpectrumIntegralResult</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">struct SpectrumIntegralResult</code></pre><p>Data on whether a matrix is spectrum integral (i.e., whether its eigenvalues are integers).</p><p>This struct also contains a map from each eigenvalue to its multiplicity, provided that the eigenvalues are indeed all integers. (Otherwise, the associated field is simply <code>nothing</code>.)</p><p><strong>Fields</strong></p><ul><li><code>matrix::Matrix{Int}</code>: the matrix whose eigenvalues and their integrality are of interest.</li><li><code>spectrum_integral::Bool</code>: whether the eigenvalues of <code>matrix</code> are all integers.</li><li><code>multiplicities::Union{Nothing,OrderedDict{Int,Int}}</code>: a map from each eigenvalue to its   multiplicity, sorted first by ascending multiplicity then by ascending eigenvalue. (This   field is <code>nothing</code> if and only if <code>spectrum_integral</code> is false, since we cannot map   non-integer eigenvalues to data.)</li></ul><p><strong>Notes</strong></p><p>If an undirected graph with integer edge weights is <code>{-1,0,1}</code>-diagonalizable (or, more restrictively, <code>{-1,1}</code>-diagonalizable), then its Laplacian matrix has integer eigenvalues [<a href="#JP25">JP25</a>, p. 312]. Hence, validating Laplacian integrality serves as a useful screening step in this package&#39;s principal <em>S</em>-bandwidth minimization algorithm.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GraphQuantum/SDiagonalizability.jl/blob/4121fb25fe287e2c320ac12784444e5551a95828/src/types.jl#L57-L78">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SDiagonalizability._SSpectra" href="#SDiagonalizability._SSpectra"><code>SDiagonalizability._SSpectra</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_SSpectra{A,B,C,D}</code></pre><p>[TODO: Write here]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GraphQuantum/SDiagonalizability.jl/blob/4121fb25fe287e2c320ac12784444e5551a95828/src/types.jl#L85-L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="LinearAlgebra.rank" href="#LinearAlgebra.rank"><code>LinearAlgebra.rank</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">rank(A::QRPivoted{&lt;:Any, T}; atol::Real=0, rtol::Real=min(n,m)*ϵ) where {T}</code></pre><p>Compute the numerical rank of the QR factorization <code>A</code> by counting how many diagonal entries of <code>A.factors</code> are greater than <code>max(atol, rtol*Δ₁)</code> where <code>Δ₁</code> is the largest calculated such entry. This is similar to the <code>rank(::AbstractMatrix)</code> method insofar as it counts the number of (numerically) nonzero coefficients from a matrix factorization, although the default method uses an SVD instead of a QR factorization. Like <code>rank(::SVD)</code>, this method also re-uses an existing matrix factorization.</p><p>Computing rank via QR factorization should almost always produce the same results as via SVD, although this method may be more prone to overestimating the rank in pathological cases where the matrix is ill-conditioned. It is also worth noting that it is generally faster to compute a QR factorization than an SVD, so this method may be preferred when performance is a concern.</p><p><code>atol</code> and <code>rtol</code> are the absolute and relative tolerances, respectively. The default relative tolerance is <code>n*ϵ</code>, where <code>n</code> is the size of the smallest dimension of <code>A</code> and <code>ϵ</code> is the <code>eps</code> of the element type of <code>A</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GraphQuantum/SDiagonalizability.jl/blob/4121fb25fe287e2c320ac12784444e5551a95828/src/utils.jl#L171-L189">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SDiagonalizability._assert_matrix_is_undirected_laplacian-Tuple{AbstractMatrix{&lt;:Integer}}" href="#SDiagonalizability._assert_matrix_is_undirected_laplacian-Tuple{AbstractMatrix{&lt;:Integer}}"><code>SDiagonalizability._assert_matrix_is_undirected_laplacian</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">_assert_matrix_is_undirected_laplacian(L)</code></pre><p>Validate that <code>L</code> is the Laplacian matrix of an undirected, possibly weighted graph.</p><p><strong>Arguments</strong></p><ul><li><code>L::AbstractMatrix{&lt;:Integer}</code>: the purported Laplacian matrix.</li></ul><p><strong>Returns</strong></p><ul><li><code>nothing</code>: if the check is passed, no output is produced.</li></ul><p><strong>Throws</strong></p><ul><li><code>DomainError</code>: if <code>L</code> is not symmetric or has nonzero row sums.</li></ul><p><strong>Examples</strong></p><p>The Laplacian matrix of the (undirected) star graph on <code>5</code> vertices passes the check:</p><pre><code class="language-julia-repl hljs">julia&gt; L = [ 4  -1  -1  -1  -1;
            -1   1   0   0   0;
            -1   0   1   0   0;
            -1   0   0   1   0;
            -1   0   0   0   1]
5×5 Matrix{Int64}:
  4  -1  -1  -1  -1
 -1   1   0   0   0
 -1   0   1   0   0
 -1   0   0   1   0
 -1   0   0   0   1

julia&gt; isnothing(SDiagonalizability._assert_matrix_is_undirected_laplacian(L))
true</code></pre><p>The adjacency matrix of the (undirected) cycle graph on <code>4</code> vertices is symmetric but has nonzero row sums, so it fails the check:</p><pre><code class="language-julia-repl hljs">julia&gt; A = [0  1  0  1;
            1  0  1  0;
            0  1  0  1;
            1  0  1  0]
4×4 Matrix{Int64}:
 0  1  0  1
 1  0  1  0
 0  1  0  1
 1  0  1  0

julia&gt; SDiagonalizability._assert_matrix_is_undirected_laplacian(A)
ERROR: DomainError with [0 1 0 1; 1 0 1 0; 0 1 0 1; 1 0 1 0]:
Matrix has nonzero row sums; cannot be an (undirected) Laplacian
[...]</code></pre><p>Both the in-degree and out-degree Laplacian matrices of this random tournament digraph have zero row sums but are not symmetric, so they fail the check. (These are the two standard ways of extending the concept of the Laplacian to directed graphs [<a href="#VL20">VL20</a>, p. 196].)</p><pre><code class="language-julia-repl hljs">julia&gt; using Graphs

julia&gt; G = random_tournament_digraph(3; seed=87)
{3, 3} directed simple Int64 graph

julia&gt; L_in = laplacian_matrix(G; dir=:in)
3×3 SparseArrays.SparseMatrixCSC{Int64, Int64} with 5 stored entries:
  ⋅  ⋅   ⋅
 -1  2  -1
 -1  ⋅   1

julia&gt; SDiagonalizability._assert_matrix_is_undirected_laplacian(L_in)
ERROR: DomainError with sparse([2, 3, 2, 2, 3], [1, 1, 2, 3, 3], [-1, -1, 2, -1, 1], 3, 3):
Matrix is not symmetric; cannot be an (undirected) Laplacian
[...]

julia&gt; L_out = laplacian_matrix(G; dir=:out)
3×3 SparseArrays.SparseMatrixCSC{Int64, Int64} with 5 stored entries:
 2  -1  -1
 ⋅   ⋅   ⋅
 ⋅  -1   1

julia&gt; SDiagonalizability._assert_matrix_is_undirected_laplacian(L_out)
ERROR: DomainError with sparse([1, 1, 3, 1, 3], [1, 2, 2, 3, 3], [2, -1, -1, -1, 1], 3, 3):
Matrix is not symmetric; cannot be an (undirected) Laplacian
[...]</code></pre><p><strong>Notes</strong></p><p>If edges are to be bidirectional, then <code>L</code> must be symmetric. <code>L</code> must also have zero row sums, since the <code>(i, i)</code>-th entry is the weighted degree of node <code>i</code> (the sum of all incident edges&#39; weights) and the <code>(i, j)</code>-th entry for <code>i ≠ j</code> is the negation of the weight of edge <code>(i, j)</code> (or simply <code>0</code>, if no such edge exists).</p><p>Given the highly optimized, lazy, zero-allocation implementation of <code>LinearAlgebra.issymmetric</code>, the symmetry check is performed first. (Both steps are <code>O(n²)</code> in the worst case, but testing for symmetry is far more performant in practice.) This also allows us to (also lazily) check for nonzero column sums rather than nonzero row sums (since these are equivalent for symmetric matrices) in the second step, taking advantage of Julia&#39;s column-major storage model.</p><p>At first blush, it may seem as though the choice of <code>DomainError</code> over something like <code>ArgumentError</code> (or even simply the return of a boolean) constitutes poor design. However, this is informed by the simple <em>ad hoc</em> use of this function to validate inputs for other functions requiring Laplacian matrices. Certainly, this function is never meant to be publicly exposed on its own.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GraphQuantum/SDiagonalizability.jl/blob/4121fb25fe287e2c320ac12784444e5551a95828/src/utils.jl#L7-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SDiagonalizability._rank_rtol-Union{Tuple{AbstractMatrix{T}}, Tuple{T}} where T" href="#SDiagonalizability._rank_rtol-Union{Tuple{AbstractMatrix{T}}, Tuple{T}} where T"><code>SDiagonalizability._rank_rtol</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">function _rank_rtol(A::AbstractMatrix{&lt;:Real})</code></pre><p>Return a reasonable relative tolerance for computing matrix rank via SVD or QRD.</p><p>The output is intended to be passed as a keyword argument to <code>LinearAlgebra.rank</code>. <code>LinearAlgebra.eigtype</code> is used to determine the appropriate machine epsilon for the element type of <code>A</code> when <code>eltype(A)</code> is not an <code>AbstractFloat</code>.</p><p><strong>Arguments</strong></p><ul><li><code>A::AbstractMatrix{&lt;:Real}</code>: the matrix for which to compute a tolerance.</li></ul><p><strong>Returns</strong></p><ul><li><code>tol::Float64</code>: a reasonable relative tolerance for computing matrix rank via SVD or QRD.   This scales proportionally to the maximum dimension of <code>A</code>.</li></ul><p><strong>Notes</strong></p><p><code>LinearAlgebra.rank</code>&#39;s default <code>rtol</code> of <code>min(m,n) * ϵ</code> for computing the rank of an <code>m × n</code> matrix may result in overestimating rank when <code>|m - n| ≫ 0</code>, since condition number (which determines how numerically stable SVD and QRD are) grows with both dimensions [<a href="#CD05">CD05</a>, p. 603]. Given that we often deal with short-and-fat matrices in this package (particularly when processing all <code>{-1,0,1}</code>-eigenvectors of a Laplacian matrix), we turn instead to the same relative tolerance used by NumPy&#39;s and MATLAB&#39;s rank functions—<code>max(m,n) * ϵ</code> [<a href="#Num25">Num25</a>, <a href="#MAT25">MAT25</a>]. (Indeed, this is a widely adopted standard across the field of numerical analysis [<a href="#PTVF07">PTVF07</a>, p. 795].)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/GraphQuantum/SDiagonalizability.jl/blob/4121fb25fe287e2c320ac12784444e5551a95828/src/utils.jl#L129-L154">source</a></section></article><h2 id="References"><a class="docs-heading-anchor" href="#References">References</a><a id="References-1"></a><a class="docs-heading-anchor-permalink" href="#References" title="Permalink"></a></h2><div class="citation canonical"><dl><dt>[CD05]</dt><dd><div id="CD05">Z. Chen and J. Dongarra. <a href="https://doi.org/10.1137/040616413"><em>Condition Numbers of Gaussian Random Matrices</em></a>. <em>SIAM Journal on Matrix Analysis and Applications</em> <strong>27</strong>, 603–20 (2005).</div></dd><dt>[JP25]</dt><dd><div id="JP25">N. Johnston and S. Plosker. <a href="https://doi.org/10.1016/j.laa.2024.10.016"><em>Laplacian {−1,0,1}- and {−1,1}-diagonalizable graphs</em></a>. <em>Linear Algebra and its Applications</em> <strong>704</strong>, 309–39 (2025).</div></dd><dt>[PTVF07]</dt><dd><div id="PTVF07">W. H. Press, S. A. Teukolsky, W. T. Vetterling and B. P. Flannery. <a href="https://dl.acm.org/doi/10.5555/1403886"><em>Numerical Recipes: The Art of Scientific Computing</em></a>. 3rd Edition (Cambridge University Press, Cambridge, UK, 2007). ISBN: 978-0-521-88068-8.</div></dd><dt>[VL20]</dt><dd><div id="VL20">J. J. Veerman and R. Lyons. <a href="https://doi.org/10.33581/1561-4085-2020-23-2-196-206"><em>A Primer on Laplacian Dynamics in Directed Graphs</em></a>. <em>Nonlinear Phenomena in Complex Systems</em> <strong>23</strong>, 196–206 (2020).</div></dd><dt>[MAT25]</dt><dd><div id="MAT25">MATLAB Developers, <a href="https://www.mathworks.com/help/matlab/ref/rank.html"><em>rank</em></a>. MATLAB reference documentation – R2025a (2025). Accessed: 2025-05-29.</div></dd><dt>[Num25]</dt><dd><div id="Num25">NumPy Developers, <a href="https://numpy.org/doc/stable/reference/generated/numpy.linalg.matrix_rank.html"><em>numpy.linalg.matrix_rank</em></a>. NumPy reference documentation – v2.2 (2025). Accessed: 2025-05-22.</div></dd></dl></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../public_api/">« Public API</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Friday 25 July 2025 13:25">Friday 25 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
